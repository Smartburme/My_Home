<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Text to Image Generator</title>
  <link rel="stylesheet" href="main.css" />
</head>
<body>
  <div class="container">
    <h1>Text to Image Generator (Gemini)</h1>
    <textarea id="prompt" placeholder="စာသားထည့်ပါ..."></textarea>
    <button id="generateBtn">Generate</button>
    <div id="loading">Generating image...</div>
    <div id="imageContainer"></div>
  </div>

  <script>
    const promptText = document.getElementById("prompt");
    const generateBtn = document.getElementById("generateBtn");
    const loading = document.getElementById("loading");
    const imageContainer = document.getElementById("imageContainer");

    generateBtn.addEventListener("click", async () => {
      const prompt = promptText.value.trim();
      if (!prompt) {
        alert("ကျေးဇူးပြု၍ စာသားထည့်ပါ");
        return;
      }

      loading.style.display = "block";
      imageContainer.innerHTML = "";

      try {
        const response = await fetch(
          "https://generativelanguage.googleapis.com/v1beta/models/gemini-pro-vision:generateContent?key=AIzaSyChZ-yBEIX_y-M8evNg1wrq85ByBAACoNU",
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              contents: [{ parts: [{ text: prompt }] }]
            }),
          }
        );

        const result = await response.json();
        const parts = result.candidates?.[0]?.content?.parts || [];

        // Find base64 image part
        const imagePart = parts.find(p => p.inlineData?.mimeType?.startsWith("image/"));
        if (imagePart) {
          const img = document.createElement("img");
          img.src = `data:${imagePart.inlineData.mimeType};base64,${imagePart.inlineData.data}`;
          img.alt = "Generated Image";
          imageContainer.appendChild(img);
        } else {
          alert("ပုံမထွက်ပါ။ ထပ်မံကြိုးစားပါ။");
        }
      } catch (err) {
        console.error(err);
        alert("အမှားတစ်ခုဖြစ်ပွားခဲ့သည်။");
      } finally {
        loading.style.display = "none";
      }
    });
  </script>
</body>
</html>
